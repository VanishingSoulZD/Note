# CHAPTER 1 计算机系统漫游  

**程序编译链接过程**  
.c -> (预处理器cpp) -> .i -> (编译器ccl) -> .s -> (汇编器as) -> .o -> (链接器ld) -> 可执行目标文件  

### 系统的硬件组成  
**总线**  
贯穿整个系统的一组电子管道。它携带信息字节并负责在各个部件间传递。通常总线被设计成传送定长的字节快，也就是子。  
  
**I/O设备**  
I/O设备是系统与外部世界的联系通道。每个I/O设备都通过一个控制器或适配器与I/O总线相连。控制器和适配器之间的区别主要在于它们的封装方式。  
控制器是I/O设备本身或者系统的主印制电路板（通常称为主板）上的芯片。  
适配器是一块插在主板插槽上的卡。  
  
**主存**  
主存是一个临时存储设备，在处理器执行程序时，用来存放程序和程序处理的数据。  
  
**处理器**  
中央处理单元（CPU），简称处理器，是解释（或执行）存储在主存中指令的引擎。处理器的核心是一个大小为一个字的存储设备（或寄存器），称为程序计数器（PC）。在任何时刻，PC都指向主存中的某条机器语言指令（即含有该条指令的地址）。  
  
执行一条指令的步骤：  
- 处理器从程序计数器指向的内存处读取指令  
- 解释指令中的位  
- 执行该指令指示的简单操作  
- 更新PC，使其指向下一条指令，下一条指令并不一定和在内存中刚刚执行的指令相邻  
  
CPU在指令的要求下可能会执行这些操作：  
- 加载：从主存复制一个字节或者一个字到寄存器，以覆盖寄存器原来的内容  
- 存储：从寄存器复制一个字节或者一个字到主存的某个位置，以覆盖这个位置上原来的内容  
- 操作：把两个寄存器的内容复制到ALU，ALU对这两个字做算术运算，并将结果存放到一个寄存器中，以覆盖该寄存器中原来的内容  
- 跳转：从指令本身中抽取一个字，并将这个字复制到程序计数器PC中，以覆盖PC中原来的值  
  
**直接存储器存取DMA**  
数据可以不通过处理器而直接从磁盘到达主存  
  
**高速缓存**  
处理器从寄存器文件中读数据比从主存中读取几乎要快100倍，而且随着这些年半导体技术的进步,这种处理器与主存之间的差距还在持续增大。针对这种处理器与主存之间的差异，系统设计者采用了更小更快的存储设备，称为高速缓存存储器(cache memory，简称为cache或高速缓存)，作为暂时的集结区域，存放处理器近期可能会需要的信息。位于处理器芯片上的L1高速缓存的容量可以达到数万字节，访问速度几乎和访问寄存器文件一样快。一个容量为数十万到数百万字节的更大的L2高速缓存通过一条特殊的总线连接到处理器。进程访问L2高速缓存的时间要比访问L1高速缓存的时间长5倍，但是这仍然比访问主存的时间快5~10倍。Ll和L2高速缓存是用一种叫做静态随机访问存储器(SRAM)的硬件技术实现的。  
  
**操作系统的两个基本功能**  
- 防止硬件被失控的应用程序滥用  
- 向应用程序提供简单一致的机制来控制复杂而又通常大不相同的低级硬件设备  
文件是对IO设备的抽象表示  
虚拟内存是对主存和磁盘IO设备的抽象表示  
进程是对处理器、主存和IO设备的抽象表示  
虚拟机是对整个计算机的抽象，包括操作系统、处理器和程序。因为一些计算机必须能够运行为不同的操作系统或同一操作系统的不同版本设计的程序。  
  
**进程**  
进程是操作系统对一个正在运行的程序的一种抽象。  
操作系统保持跟踪进程运行所需的所有状态信息。这种状态，也就是上下文，包括许多信息，比如PC和寄存器文件的当前值，以及主存的内容。在任何一个时刻，单处理器系统都只能执行一个进程的代码。当操作系统决定要把控制权从当前进程转移到某个新进程时，就会进行上下文切换，即保存当前进程的上下文、恢复新进程的上下文，然后将控制权传递到新进程。新进程就会从它，上次停止的地方开始。  
内核是操作系统代码常驻内存的部分。内核不是一个独立的进程，它是系统管理全部进程所用代码和数据结构的集合。  
  
**进程的虚拟地址空间**  
程序区，数据区，运行时堆，共享库的内存映射区域（用来存放像C标准库和数学库这样的共享库的代码和数据的区域），栈，内核虚拟内存（不允许应用程序读写这个区域的内容或者直接调用内核代码定义的函数，相反，它们必须调用内核来执行这些操作）  
  


